Protocols & Servers 1:
    * This room introduces some common protocols such as:
        
    TELNET, HTTP, FTP, POP3, SMTP, IMAP

    TELNET:
        * Telnet is an applcation layer protocol, used to connect to a virtual terminal of another computer.
        * Telnet allows user to log into a different computer, acces terminal and  run programs, start batch processes, and perform system administration tasks remotely.

        * Telnet is simple: Username & Password authentication.
        * However Telnet is plaintext. As a result, not reliable for remote administration.

        * Telnet server uses Telnet protocol to listen to TCP port 23 default.


    HYPERTEXT TRANSFER PROTOCOL (HTTP):
        * Protocol used to transfer web pages. Browser connects and uses HTTP to request HTML pages, images, submit forms, upload files etc.
        * Anytime we browse the web we use HTTP. HTTP not encrypted!
        * We can use Telnet or Netcat or other to communicate with web server and appear as a browser.
            * Need to input HTTP commands manually!
        
        USING TELNET TO REQUEST A FILE:
            * Connect to port 80            telnet 10.10.36.132 80
            * Retrieve page                 GET /index.html HTTP/1.1
            * Retrieve default page         GET / HTTP/1.1
            * Provide some name             host: telnet
            Press ENTER x 2.

        * We need a HTTP Client (browser) and HTTP Server (webserver) to use HTTP protocol.
        * Web server 'serves' a certain set of files to the requesting browser.

        * Popular HTTP Servers:     Apache, Internet Information Services (IIS), nginx. 
            IIS is paid, others are open source.

        NOTE! TELNET COMMANDS TO RETRIEVE FILE:
            * GET /flag.thm HTTP/1.1

    FILE TRANSFER PROTOCOL (FTP):   
        * Sends and receives data in cleartext. Used to transfer files between different systems efficiently.
        * Therefore can use netcat or telnet to communicate with an FTP server and act as FTP client.
        * FTP listens on port 21 as default.

        Steps:
            * ftp 10.10.36.132 21               Connects to FTP
            * Enter credentials
            * Use ls, cd to find important files.
            * Use get filename.txt to transfer.
            * Consider using STAT (server status & more), PASV (switches mode to passive), SYST (System type of target (UNIX etc.))
            * Exit & use cat to read files.

            * TYPE A switches file transfer mode to ASCII.
            * TYPE I switches file transfer mode to binary.

        Two channels: Control channel & Data channel
        * All commands are sent over control channel.
        * Once client requests file, another TCP connection is established.
        

    SIMPLE MAIL TRANSFER PROTOCOL (SMTP):
        * Email delivery over internet requires 4 things:

            Mail User Agent (MUA)           Client, wants to send mail      Connects to MSA to send message.
            Mail Submission Agent (MSA)     Receives message, checks for errors, transfers to MTA server. (Commonly on the same server).
            Mail Transfer Agent (MTA)       Sends message to the MTA of the recipient.      Can also function as MSA.
            Mail Delivery Agent (MDA)       MTA often functions as MDA also.        Recipient collects email from MDA using email client.

        * We need to rely on email protocols to communicate with MTA and MDA. These are:
            - SMTP (Simple Mail Transfer Protocol).
            - Post Office Protocol v3 (POP3)        OR      Internet Message Access Protocol (IMAP).

        * SMTP is used to communicate with MTA server. Not encrypted. Sent in plaintext.
        * Therefore can use telnet client conection to connect to SMTP server (port 25) and act as email client (MUA) to send message.
        
        Steps: (Using telnet)
            * telnet IP_ADDR 25     where port 25 is target.
            * helo HOSTNAME         insert name
            * mail from: 250 2.1.0 
            * rcpt to:      e.g frank
            * 250 2.1.5 Ok
            * data
            **INCLUDE COMMANDS IN DATA!
            * Use . to end data

    
    POP3 (Post Office Prot v3):
        * Protocol used to download email messages from MDA server.
        * Client connects to POP3 server, authenticates, downloads new emails before optionally deleting them.
        * POP3 default port is 110. Conenct through telnet:
            telnet IP_ADDR 110
            Authenticate... USER frank      PASS password
            Use command STAT, positive response has form +OK nn mm
            LIST lists the new messages on the server.
            RETR 1 retrieves the first in the list.


    IMAP (Internet Message Access Protocol):
        * More sophisticated than POP3. Allows synchronisation of emails across multiple clients.
        * IMAP uses default port 143. 
            - telnet ... 143
            - c1 LOGIN username password
            - c2 LIST "" "*"
            - c3 EXAMINE INBOX
            - c4 logout

        
    SUMMARY: 
        Protocol 	TCP Port 	Application(s) 	    Data Security
        FTP 	    21 	        File Transfer 	    Cleartext
        HTTP 	    80 	        Worldwide Web 	    Cleartext
        IMAP 	    143 	    Email (MDA) 	    Cleartext
        POP3 	    110 	    Email (MDA) 	    Cleartext
        SMTP 	    25 	        Email (MTA) 	    Cleartext
        Telnet 	    23 	        Remote Access 	    Cleartext

    